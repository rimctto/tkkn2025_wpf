<UserControl
    x:Class="tkkn2025.GameObjects.Ship.ShipSprite"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:tkkn2025.GameObjects.Ship"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Width="40"
    Height="40"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <!--  Flame geometry  -->
        <sys:Double x:Key="FlameLength">10</sys:Double>

        <!--  Scale range  -->
        <sys:Double x:Key="IdleMinScale">0.8</sys:Double>
        <sys:Double x:Key="IdleMaxScale">1.2</sys:Double>

        <!--  Precomputed translate values  -->
        <sys:Double x:Key="IdleTranslateAtMin">2.0</sys:Double>
        <sys:Double x:Key="IdleTranslateAtMax">-2.0</sys:Double>

        <!--  Duration  -->
        <Duration x:Key="IdleDuration">0:0:0.4</Duration>
    </UserControl.Resources>

    <Canvas Width="40" Height="40">

        <!--  Rear booster flame  -->
        <Polygon
            x:Name="RearFlame"
            Canvas.Left="20"
            Canvas.Top="20"
            Fill="OrangeRed"
            IsHitTestVisible="False"
            Points="-5,10 5,10 0,20"
            RenderTransformOrigin="0.5,0"
            Stroke="Yellow"
            StrokeThickness="1">
            <Polygon.RenderTransform>
                <TransformGroup>
                    <ScaleTransform x:Name="RearFlameScale" ScaleX="1" ScaleY="1" />
                    <TranslateTransform x:Name="RearFlameTranslate" Y="0" />
                </TransformGroup>
            </Polygon.RenderTransform>
        </Polygon>

        <!--  Neutral ship body  -->
        <Canvas x:Name="ShipNeutral">

            <Polygon
                Canvas.Left="20"
                Canvas.Top="20"
                Fill="LightBlue"
                Points="0,-15 -10,10 10,10"
                Stroke="White"
                StrokeThickness="2" />
            <Ellipse
                Canvas.Left="16"
                Canvas.Top="13"
                Width="8"
                Height="11"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Fill="DarkBlue"
                Stroke="Black"
                StrokeThickness="1" />
        </Canvas>

        <!--  Ship body tilted RIGH  -->
        <Canvas x:Name="ShipRight" Visibility="Collapsed">
            <Polygon
                Canvas.Left="20"
                Canvas.Top="20"
                Fill="LightBlue"
                Points="0,-15 -10,10 10,10"
                Stroke="White"
                StrokeThickness="2" />
            <Ellipse
                Canvas.Left="20"
                Canvas.Top="13"
                Width="8"
                Height="11"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Fill="DarkBlue"
                Stroke="Black"
                StrokeThickness="1" />
        </Canvas>


        <!--  Ship window / cockpit  -->
        <Canvas x:Name="ShipLeft" Visibility="Collapsed">
            <Polygon
                Canvas.Left="20"
                Canvas.Top="20"
                Fill="LightBlue"
                Points="0,-15 -10,10 10,10"
                Stroke="White"
                StrokeThickness="2" />
            <Ellipse
                Canvas.Left="13"
                Canvas.Top="13"
                Width="8"
                Height="11"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Fill="DarkBlue"
                Stroke="Black"
                StrokeThickness="1" />
        </Canvas>
    </Canvas>

    <!--  Animations  -->
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <BeginStoryboard>
                <Storyboard AutoReverse="True" RepeatBehavior="Forever">
                    <!--  Scale Y  -->
                    <DoubleAnimation
                        Storyboard.TargetName="RearFlameScale"
                        Storyboard.TargetProperty="ScaleY"
                        From="{StaticResource IdleMinScale}"
                        To="{StaticResource IdleMaxScale}"
                        Duration="{StaticResource IdleDuration}" />
                    <!--  Translate Y (keeps top fixed)  -->
                    <DoubleAnimation
                        Storyboard.TargetName="RearFlameTranslate"
                        Storyboard.TargetProperty="Y"
                        From="{StaticResource IdleTranslateAtMin}"
                        To="{StaticResource IdleTranslateAtMax}"
                        Duration="{StaticResource IdleDuration}" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </UserControl.Triggers>
</UserControl>