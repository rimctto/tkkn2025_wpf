<Window
    x:Class="tkkn2025.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:gameObjects="clr-namespace:tkkn2025.GameObjects"
    xmlns:local="clr-namespace:tkkn2025"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:settingsModels="clr-namespace:tkkn2025.Settings.Models"
    xmlns:ui="clr-namespace:tkkn2025.UI"
    Title="TKKN 2025"
    Width="1100"
    Height="700"
    Focusable="True"
    KeyDown="Window_KeyDown"
    KeyUp="Window_KeyUp"
    ResizeMode="NoResize"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <Window.Resources>
        <!--  Default Button Style  -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="#FF2D2D30" />
            <Setter Property="Foreground" Value="white" />
            <Setter Property="BorderBrush" Value="Gray" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="5,2" />
            <Setter Property="FontWeight" Value="Normal" />

        </Style>

        <!--  Default TextBlock Style  -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="Normal" />
            <Setter Property="Focusable" Value="False" />

        </Style>

        <!--  Default TextBox Style  -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#FF2D2D30" />
            <Setter Property="BorderBrush" Value="Gray" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="2" />

        </Style>

    </Window.Resources>

    <Grid>
        <!--  Main Content Grid  -->
        <Grid Name="MainContentGrid">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="275" />
            </Grid.ColumnDefinitions>

            <!--  Game Area  -->
            <Canvas
                Name="GameCanvas"
                Grid.Column="0"
                Background="Black"
                Focusable="True"
                MouseDown="GameCanvas_MouseDown">

                <!--  Start Screen - shown when game is not running  -->


            </Canvas>

            <ui:StartScreen x:Name="StartScreen" Visibility="Visible" />
            <ui:GameOverScreen x:Name="GameOverScreen" Visibility="Hidden" />
            <ui:GameConfigScreen x:Name="GameConfigScreen" Visibility="Hidden" />
            <!--  Settings Panel  -->
            <Border
                Grid.Column="1"
                Padding="0"
                Background="#FF151515">
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="25" />

                    </Grid.RowDefinitions>

                    <StackPanel Margin="10">
                        <!--  FPS Counter in top right  -->
                        <TextBlock
                            Name="FpsText"
                            Margin="0,0,0,5"
                            HorizontalAlignment="Right"
                            FontWeight="Bold"
                            Foreground="Yellow"
                            Text="FPS: 0" />

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="10" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="5" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="5" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="5" />
                                <RowDefinition Height="auto" />
                            </Grid.RowDefinitions>

                            <!--  Player Name Row  -->
                            <TextBlock
                                Grid.Row="0"
                                Grid.Column="0"
                                VerticalAlignment="Center"
                                FontWeight="Bold"
                                Text="Player" />

                            <TextBox
                                Name="PlayerNameTextBox"
                                Grid.Row="0"
                                Grid.Column="2"
                                Height="25"
                                BorderBrush="MediumPurple"
                                FontWeight="Bold"
                                Text="Anonymous"
                                TextAlignment="Center" />

                            <!--  Game Time Row  -->
                            <TextBlock
                                Grid.Row="2"
                                Grid.Column="0"
                                VerticalAlignment="Center"
                                FontWeight="Bold"
                                Text="Time" />

                            <TextBlock
                                Name="GameTimeText"
                                Grid.Row="2"
                                Grid.Column="2"
                                FontWeight="Bold"
                                Text="0s"
                                TextAlignment="Center" />

                            <!--  Particle Count Row  -->
                            <TextBlock
                                Grid.Row="4"
                                Grid.Column="0"
                                VerticalAlignment="Center"
                                Text="Particles" />

                            <TextBlock
                                Name="ParticleCountText"
                                Grid.Row="4"
                                Grid.Column="2"
                                Text="0"
                                TextAlignment="Center" />

                            <!--  Session Stats Row  -->
                            <TextBlock
                                Grid.Row="6"
                                Grid.Column="0"
                                VerticalAlignment="Center"
                                FontSize="12"
                                FontWeight="Bold"
                                Text="Session" />

                            <TextBlock
                                Name="SessionStatsText"
                                Grid.Row="6"
                                Grid.Column="2"
                                FontSize="10"
                                Foreground="LightBlue"
                                Text="No games played yet"
                                TextAlignment="Center"
                                TextWrapping="Wrap" />
                        </Grid>

                        <!--  Music Control  -->
                        <Button
                            Name="MusicToggleButton"
                            Width="150"
                            Margin="0,10,0,10"
                            Background="DarkSlateBlue"
                            Click="MusicToggleButton_Click"
                            Content="🎵 Music: ON"
                            Focusable="False"
                            Foreground="White" />





                        <!--  Game Settings Header  -->
                        <TextBlock
                            Margin="0,5,0,0"
                            FontSize="14"
                            FontWeight="Bold"
                            Text="Game Settings" />

                        <!--  Settings Management Buttons  -->
                        <StackPanel
                            Margin="0,5,0,0"
                            HorizontalAlignment="Center"
                            Orientation="Horizontal">
                            <Button
                                Name="SaveSettingsButton"
                                Width="60"
                                Click="SaveSettingsButton_Click"
                                Content="Save"
                                FontSize="10" />
                            <Button
                                Name="LoadSettingsButton"
                                Width="60"
                                Margin="5,0,0,0"
                                Click="LoadSettingsButton_Click"
                                Content="Load"
                                FontSize="10" />
                            <Button
                                Name="ResetSettingsButton"
                                Width="60"
                                Margin="5,0,0,0"
                                Click="ResetSettingsButton_Click"
                                Content="Default"
                                FontSize="10" />
                        </StackPanel>

                        <!--  Config Status  -->
                        <TextBlock
                            Name="ConfigStatusText"
                            Margin="0,5,0,10"
                            HorizontalAlignment="Center"
                            FontSize="10"
                            Foreground="LightGray"
                            Text="" />


                        <Grid Margin="10,10,10,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="15" />
                                <ColumnDefinition Width="auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                Grid.Column="0"
                                FontSize="14"
                                Text="Difficulty:" />
                            <TextBlock
                                Grid.Column="2"
                                d:Text="345"
                                FontSize="14"
                                Text="{Binding GameSettings.Difficulty}" />
                        </Grid>
                    </StackPanel>

                    <!--  Game Settings  -->

                    <ScrollViewer
                        Grid.Row="1"
                        Margin="10"
                        VerticalScrollBarVisibility="Auto">


                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <StackPanel DataContext="{Binding}">

                                <!--  Basic Settings  -->
                                <Expander Foreground="White" IsExpanded="False">
                                    <Expander.Header>
                                        <TextBlock
                                            FontSize="14"
                                            Foreground="DarkCyan"
                                            Text="Basic Settings" />
                                    </Expander.Header>

                                    <settingsModels:SettingList Margin="0,10,0,0" DataContext="{Binding GameSettings.BasicSettings}" />
                                </Expander>

                                <!--  Particle Settings  -->
                                <Expander Foreground="White" IsExpanded="False">
                                    <Expander.Header>
                                        <TextBlock
                                            FontSize="14"
                                            Foreground="DarkCyan"
                                            Text="Particle Settings" />
                                    </Expander.Header>

                                    <settingsModels:SettingList Margin="0,10,0,0" DataContext="{Binding GameSettings.ParticleSettings}" />
                                </Expander>

                                <!--  PowerUp Settings  -->
                                <Expander Foreground="White" IsExpanded="False">
                                    <Expander.Header>
                                        <TextBlock
                                            FontSize="14"
                                            Foreground="DarkCyan"
                                            Text="Power-Up Settings" />
                                    </Expander.Header>
                                    <settingsModels:SettingList Margin="0,10,0,0" DataContext="{Binding GameSettings.PowerUpSettings}" />
                                </Expander>


                            </StackPanel>
                        </Grid>
                    </ScrollViewer>

                    <StackPanel
                        Grid.Row="2"
                        Margin="5,0"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                        <Button
                            Name="DatabaseButton"
                            Width="35"
                            Margin="0,0,5,0"
                            Click="DatabaseButton_Click"
                            Content="🗄️"
                            ToolTip="Open Firebase Database Editor" />
                        <Button
                            Name="DatabaseMVVMButton"
                            Width="50"
                            Margin="0,0,5,0"
                            Click="DatabaseMVVMButton_Click"
                            Content="🗄️MVVM"
                            FontSize="8"
                            ToolTip="Open Firebase Database Editor (MVVM)" />
                        <Button
                            Name="LogButton"
                            Width="35"
                            Click="LogButton_Click"
                            Content="Log"
                            ToolTip="Open Debug Log Window" />
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>


    </Grid>
</Window>
